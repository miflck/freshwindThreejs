<!DOCTYPE html>
<html lang="en">
	<head>
		<title>FreshWind</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
		<link type="text/css" rel="stylesheet" href="main.css">

		<!-- Import threejs and additional sources -->
		<script src="src/threejs/three.js"></script>
		<script src="src/threejs/stats.min.js"></script>

		<script src='src/threejs/lines/LineSegmentsGeometry.js'></script>
		<script src='src/threejs/lines/LineMaterial.js'></script>
		<script src='src/threejs/lines/LineSegments2.js'></script>
		<script src='src/threejs/lines/Line2.js'></script>

		<!-- Import wind sources -->
		<script src="src/helper.js?v=0.3"></script>
		<script src="src/WindVane.js?v=0.3"></script>
		<script src="src/Wind.js?v=0.4"></script>
		<script src="src/app.js?v=1.0"></script>


	</head>
	<body>

    <!-- container for the threejs action -->
<canvas id="c"></canvas>

<div class="text">
Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Aenean commodo ligula eget dolor. Aenean massa. 
</div>

<div class="windcontainer">1</div>


<div class="windcontainer">2</div>

<div class="text">
Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Aenean commodo ligula eget dolor. Aenean massa. 
</div>
<div class="windcontainer">3</div>
<div class="text">
Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Aenean commodo ligula eget dolor. Aenean massa. 
</div>

	<!--
<div class="windcontainer">4</div>
<div class="windcontainer">5</div>
<div class="windcontainer">6</div>
<div class="windcontainer">7</div>
<div class="text">
Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Aenean commodo ligula eget dolor. Aenean massa. 
</div>

<div class="windcontainer">8</div>
<div class="windcontainer">9</div>
<div class="windcontainer">10</div>
<div class="windcontainer">11</div>
	 -->
	<script>
	 	/* the application wants some background images*/ 
	    var files = ['images/1x/01.png','images/1x/02.png','images/1x/03.png','images/1x/04.png','images/1x/05.png','images/1x/06.png','images/1x/07.png','images/1x/08.png','images/1x/09.png','images/1x/10.png','images/1x/11.png','images/1x/12.png',];

	    //var files = ['images/2/1.png','images/2/2.png','images/2/3.png','images/2/4.png','images/2/5.png','images/2/6.png'];
	   	//var files = ['images/2/1.png'];

	    /* load the backgroundimages*/
		loadBackgroundImages(files);



		// stop automatic wind
		bIsTimed=true;

		window.onload = init;

		//  Key listener to debug and test. not necessary in production…
		document.addEventListener('keydown', function(event) {
			// w to make wind
    		if (event.keyCode == 87) {
				scenes.forEach( function ( scene ) {

					var rect = scene.userData.view.getBoundingClientRect();
					// check if it's offscreen. If so skip it
					if ( rect.bottom < 0 || rect.top > renderer.domElement.clientHeight ||
						 rect.right < 0 || rect.left > renderer.domElement.clientWidth ) {
						return; // it's off screen
					}
					makeRandomWind(scene,0);
				});
   			}
		}, false);




		/* MOUSE LISTENER könnten auch ins app.js, mache ich aber jetzt im Index für bessere Kontrolle*/

	document.addEventListener("mousedown", function(event) {
		//makeRandomWind(0);
	},false);

	document.addEventListener('mousemove', debounce(function (event) {

  		directionX = event.movementX || event.mozMovementX || event.webkitMovementX || 0;
  		directionY = event.movementY || event.mozMovementY || event.webkitMovementY || 0;
		//console.log("Debounced move "+directionX);

		scenes.forEach( function ( scene ) {

						var rect = scene.userData.view.getBoundingClientRect();
						// check if it's offscreen. If so skip it
						if ( rect.bottom < 0 || rect.top > renderer.domElement.clientHeight ||
							 rect.right < 0 || rect.left > renderer.domElement.clientWidth ) {
							return; // it's off screen
						}
					makeRandomWind(scene,0);

			});
		
	},2));
		



function debounce(fn, delay) {
	var timer = null;
	return function () {
		var context = this, args = arguments;
		clearTimeout(timer);
    	timer = setTimeout(function () {
			fn.apply(context, args);
    	}, delay);
  	};
}





	</script>

	</body>
</html>